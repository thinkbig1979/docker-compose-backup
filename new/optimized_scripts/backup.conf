
# Docker Stack Selective Sequential Backup Configuration - ENHANCED VERSION
# This file should be in the same directory as the docker-backup.sh script

# Required: Directory containing Docker compose stacks to backup
# This should be the parent directory containing subdirectories with docker-compose.yml files
BACKUP_DIR=/opt/docker-stacks

# Optional: Backup timeout in seconds
# Default: 3600 (1 hour)
# Increase for larger backup sets
BACKUP_TIMEOUT=3600

# Optional: Docker command timeout in seconds
# Default: 30
# Time to wait for docker compose stop/start commands
DOCKER_TIMEOUT=30

# Required: Restic repository configuration
# Path or URL to the restic repository (local path, sftp, s3, etc.)
# Examples:
#   Local: /home/user/backups/docker-restic-repo
#   SFTP: sftp:backup-server:/srv/backups/docker-restic-repo
#   S3: s3:s3.amazonaws.com/my-backup-bucket/docker-backups
RESTIC_REPOSITORY=""

# Required: Restic repository password
# WARNING: This password will be stored in plain text in this config file
# Consider using file permissions (chmod 600) to protect this file
# For enhanced security, consider using environment variables instead
RESTIC_PASSWORD=""

# Optional: Custom hostname for backup identification
# If unset or empty, restic will use the system hostname
# This allows you to identify backups from different environments
# Examples: production-server, staging-env, dev-machine
HOSTNAME=""

# Optional: Retention policy configuration
# These settings control how many snapshots to keep when auto-pruning
# If any KEEP_* variable is unset or empty, it will be omitted from the forget command
KEEP_DAILY=7      # Keep 7 daily snapshots
KEEP_WEEKLY=4     # Keep 4 weekly snapshots
KEEP_MONTHLY=12   # Keep 12 monthly snapshots
KEEP_YEARLY=3     # Keep 3 yearly snapshots

# Optional: Auto-prune after successful backups
# When set to true, runs 'restic forget --prune' after each successful backup
# using the retention policy defined above
AUTO_PRUNE=false

# Optional: Custom log directory
# Default: script_directory/logs
# Specify a custom path for log files if needed
# LOG_DIR=/var/log/docker-backup

# Optional: Custom dirlist file location
# Default: script_directory/dirlist
# Specify a custom path for the directory list file if needed
# DIRLIST_FILE=/etc/docker-backup/dirlist

# Example configurations for different scenarios:

# Small development setup:
# BACKUP_DIR=/home/user/docker-projects
# BACKUP_TIMEOUT=1800
# DOCKER_TIMEOUT=15
# RESTIC_REPOSITORY=/home/user/backups/docker-restic-repo
# RESTIC_PASSWORD=dev-secure-password
# HOSTNAME=dev-machine

# Medium production setup:
# BACKUP_DIR=/srv/docker-stacks
# BACKUP_TIMEOUT=3600
# DOCKER_TIMEOUT=45
# RESTIC_REPOSITORY=sftp:backup-server:/srv/backups/docker-restic-repo
# RESTIC_PASSWORD=production-secure-password
# HOSTNAME=prod-server-01
# KEEP_DAILY=14
# KEEP_WEEKLY=8
# KEEP_MONTHLY=24
# KEEP_YEARLY=5
# AUTO_PRUNE=true

# Large enterprise setup:
# BACKUP_DIR=/srv/docker-stacks
# BACKUP_TIMEOUT=7200
# DOCKER_TIMEOUT=60
# RESTIC_REPOSITORY=s3:s3.amazonaws.com/company-backups/docker-prod
# RESTIC_PASSWORD=enterprise-secure-password
# HOSTNAME=prod-cluster-node-01
# KEEP_DAILY=30
# KEEP_WEEKLY=12
# KEEP_MONTHLY=36
# KEEP_YEARLY=10
# AUTO_PRUNE=true
# LOG_DIR=/var/log/docker-backup
# DIRLIST_FILE=/etc/docker-backup/dirlist

# Security and Performance Notes:
# - BACKUP_DIR must exist and be readable
# - Each subdirectory in BACKUP_DIR should contain a docker-compose.yml file
# - RESTIC_REPOSITORY and RESTIC_PASSWORD must be configured in this file
# - The script uses selective, sequential processing - edit .dirlist to control which directories are backed up
# - New directories are disabled by default (opt-in approach)
# - This configuration file must be in the same directory as the docker-backup.sh script
#
# Security Recommendations:
# - RESTIC_PASSWORD is stored in plain text in this file
# - Protect this file with appropriate permissions: chmod 600 backup.conf
# - Consider using a dedicated backup user with limited privileges
# - Environment variables RESTIC_REPOSITORY and RESTIC_PASSWORD are used as fallback
#   if not specified in this config file (for backward compatibility)
# - Consider using external secret management for production environments
#
# Performance Tuning:
# - Increase BACKUP_TIMEOUT for large datasets
# - Adjust DOCKER_TIMEOUT based on container shutdown complexity
# - Use local storage for RESTIC_REPOSITORY for fastest backups
# - Consider network bandwidth when using remote repositories
# - Monitor log files for performance bottlenecks
